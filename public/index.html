<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>WebXR AR Experience</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Variant Launch SDK: enables WebXR immersive-ar on iOS and other platforms -->
    <script src="https://launchar.app/sdk/v1?key=tF9tOpUzqoCcVs7jfwxWUSBKZv6OF8zp&redirect=true"></script>
</head>
<body>
    <!-- AR Canvas Container -->
    <div id="ar-container"></div>

    <!-- Start AR Button -->
    <button id="start-button" class="start-button">Start AR</button>

    <!-- Reset Button (only visible for WebXR) -->
    <button id="reset-button" class="reset-button hidden">Reset</button>

    <!-- WebXR Instruction (shown briefly when WebXR starts) -->
    <div id="webxr-instruction" class="webxr-instruction hidden">
        <p>Point at a surface and tap to place content</p>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Load Toast Notification System first (for error display) -->
    <script src="toast.js"></script>
    
    <!-- Load Three.js core library -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.149.0/build/three.min.js"></script>
    <script>
        // Verify THREE loaded correctly
        if (typeof THREE === 'undefined') {
            console.error('THREE.js failed to load!');
            if (window.Toast) {
                window.Toast.error('Failed to load Three.js library.', 'Load Error', 8000);
            }
        } else {
            console.log('✅ THREE.js loaded successfully, version:', THREE.REVISION);
        }
    </script>
    
    <!-- Load GLTFLoader - using synchronous script tag (simple and reliable, like bouncing-band) -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.149.0/examples/js/loaders/GLTFLoader.js"></script>
    <script>
        // Verify GLTFLoader loaded correctly
        if (typeof THREE !== 'undefined' && typeof THREE.GLTFLoader !== 'undefined') {
            console.log('✅ GLTFLoader loaded successfully');
        } else {
            console.error('❌ GLTFLoader failed to load!');
            if (window.Toast) {
                window.Toast.error('Failed to load GLTFLoader. 3D models will not work. Please check your internet connection and try refreshing.', 'Loader Error', 10000);
            }
        }
    </script>

    <!-- Load Platform Detector first -->
    <script src="platform-detector.js"></script>
    
    <!-- Load AR Controller (WebXR-only, will dynamically load main-webxr.js) -->
    <script src="ar-controller.js"></script>
</body>
</html>

